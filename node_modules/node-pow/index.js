var path = require('path');
var fs = require('fs');

var home = process.env.HOME || process.env.HOMEPATH || process.env.USERPROFILE;
var powPath = NodePow.powPath = path.join(home, '.pow');

function NodePow (name, port) {
  if ('number' === typeof name && 'string' === typeof port) {
    port = [name, name = port][0];
  }

  if ('object' === typeof name) {
    port = name.port;
    name = name.name;
  }

  if ('function' === typeof name) {
    port = name.get('port');
    name = name.get('title');
  }

  if (!fs.statSync(powPath).isDirectory())  {
    fs.mkdirSync(powPath);
  }
  fs.writeFileSync(path.join(powPath, name), port.toString());
}

module.exports = NodePow;

